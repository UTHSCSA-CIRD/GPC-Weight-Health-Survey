---
title: 'Patient Engagement in Clinical Data Research Networks: The 2015 Greater Plains
  Collaborative Health and Medical Research Family Survey'
output:
  word_document:
    keep_md: yes
  html_notebook: default
  pdf_document: default
  html_document:
    keep_md: yes
---
```{r, include=FALSE}
load('obesityPaper01.rdata');
require(magrittr); require(dplyr); require(knitr);
require(pander);
source('functions.R');
.gimme.formals <- formals(gimme);
formals(format.default)$big.mark <- ',';
knitr::opts_chunk$set(echo = FALSE,message=FALSE,warning=FALSE,results='asis');
```

```{r notice}
cat(tb$notice);
```


# Abstract

**Objective:** The aim of this paper is to report on the initial obesity project from the Greater Plains Collaborative (GPC), a Clinical Data Research Network (CDRN) that is part of the Patient Centered Outcomes Research Institute (PCORI) National Patient Centered Clinical Research Network (PCORNet). 

**Materials and Methods:** The electronic health records of 10 academic medical centers in 8 Midwestern states were coordinated in order to allow for a prospective multi-site obesity focused research project to be conducted. A survey was designed to assess participant willingness for themselves, and their children (if appropriate) to participate in research, as well as the use of their health record data for research.The survey was composed of 7 questions regarding interest in medical research, as well as basic demographic and health related information. Each site had a goal of 1,000 initial positive survey responses and 100 completed surveys.
```{r}
formals(gimme)[c('the','modify','data','fromgroup')]<-alist(the='percent'
                                                            ,modify=pct
                                                            ,data=tb$dResComp
                                                            ,fromgroup='TRUE');
```
**Results:** A cohort of `r format(nrow(obd))` patients was created across the participating sites.  The eligible patient population was `r gimme(of='Sex',thats='Female')` female, `r gimme(of='Race',thats='Caucasian')` Caucasian, `r gimme(of='Financial.Class',thats='Self-Pay')` self-pay, with mean age of `r gimme('mean',of='Age',m=format,di=3)` (`r gimme('sd',of='Age',m=format,di=2)`) years with `r gimme(of='BMI',thats='Overweight')` overweight and `r gimme(of='BMI',thats='Obese')` obese. In general, a third of respondents had participated in research previously and were positive about being contacted for additional research both for themselves and for their children. Responses did vary by site.  

# Background and Significance

...text omitted...

## GPC Member Sites

...text omitted...

# Objective

...text omitted...

------ ------------------------
&nbsp; Table 1, Survey Questions
       (placeholder)
-------------------------------

# Materials and Methods

...text omitted...

## Institutional Review Board Process

...text omitted...

## Data Harmonization

...text omitted...

## Cohort Identification

...text omitted...

------ ------------------------
&nbsp; Table 2, Eligibility Query
       (placeholder)
-------------------------------

## Contacting Participants

Potential participants were contacted through one of three means: the United States Postal Service (USPS), email (EMAIL), or through the patient portal feature of the electronic medical record systems (PORTAL). The method of contact was selected by each HMRFS site PI based on logistics and local policy requirements. For a detailed list of site and contact method see Table 3. Whether adult patients, pediatric patients, or both were contact for the current study also varied by site (Table 3).

```{r}
cat(tb$t03.sitemethod);
```

---

```{r}
cat(tb$t04a.adultsites);
```

---

```{r}
cat(tb$t04b.pedsites);
```

...text omitted...

## Analysis Plan

# Results

![Figure 1: Current draft of consort diagram with comments.](./figure01_obesityPaper01.png "Figure 1: Consort Diagram")

---

```{r}
cat(tb$t05.eligible);
```

...text omitted...

```{r}
cat(tb$t06a.eligBySite)
```

---

```{r}
cat(tb$t06b.resBySite);
```

---

```{r}
cat(tb$t06c.compBySite);
formals(gimme)[c('data')] <- alist(data=tb$dEligBySiteRange);
```

Sample size and demographics varied by site (Table 6a). Sample size by site varied from a maximum of `r gimme('max',thats='n',mo=format)` (`r gimme('whichmax',thats='n',mo=format)`) to a minimum of `r gimme('min',thats='n',mo=format)` (`r gimme('whichmin',thats='n',mo=format)`). The proportion of the cohort that was male at each site varied widely  from  `r gimme('max',thats='Sex=Male')`  to  `r gimme('min',thats='Sex=Male')`.  The  proportion  of  African  Americans  in  the  cohort  at  each  site  also  varied widely (`r gimme('max',thats='Race=African American')` - `r gimme('min',thats='Race=African American')`) as did the proportion of Native Americans (`r gimme('max',thats='Race=Native American')` - `r gimme('min',thats='Race=Native American')`) and the proportion of Asians (`r gimme('max',thats='Race=Asian')` - `r gimme('min',thats='Race=Asian')`). Insurance status type varied widely by site as well; the most common were self-pay (`r gimme('max',thats='Financial.Class=Self-Pay')` - `r gimme('min',thats='Financial.Class=Self-Pay')`),  Medicaid (`r gimme('max',thats='Financial.Class=Medicaid')` - `r gimme('min',thats='Financial.Class=Medicaid')`)  and  private  insurance  (`r gimme('max',thats='Financial.Class=Private Insurance')` - `r gimme('min',thats='Financial.Class=Private Insurance')`).  _Approximated  annual  income ranged from $40,000-70,000/year, and mean age for the target child ranged from 9.47 years â€“12.33. Three sites targeted adults as they  did not have children in their systems, and their average age was 36.15 (7.74) years  or 47.83  (15.1)  years.  Finally,  baseline  body  mass  index  (BMI)  for  the  participating  adult  individual  calculated from self-reported height and weight on the survey ranged from 20.30 (5.24) to 30.35 (7.27)._ Table 6b indicates these same variables by site for responders to Survey 1, and Table 6c indicates the same variables by site for Survey 2 respondents.

```{r}
.n01 <- sapply(tb$d02.rsamples,length);
```

## EHR Predictors of Participation
Prior to analysis the `r format(sum(.n01))` records were randomly assigned to a development (N=`r format(.n01['train'])`), 
validation (N=`r format(.n01['val'])`), and test subsets 
(N=`r format(.n01['test'])`) in order to avoid overfitting and bias due to within-sample testing. All analysis
decisions were made based on the developmental subset. The first
goal was to identify candidate predictors for survey participation from among the variables available for all  members of the cohort (i.e. those listed in Table 5). 

Accordingly, for each candidate predictor, a separate logistic regression model was fit to the developmental subset with responder
status as the outcome. Discrete variables with multiple levels were broken up into an equal number of indicator variables. This not only informed the decision of which predictor and random-effect variables but also in some cases how condense their levels. Table 8 shows the results of these `r length(tb$t07.univar) - 2` tests.
```{r}
cat(tb$t07.univar);
```

## HMRFS Survey

```{r, results='hide', echo=FALSE, message=FALSE, warning=FALSE}
formals(gimme)[c('the','modify','data','fromgroup','thats')] <- alist(the='percent',modify=pct,data=tb$dSurv,fromgroup='Overall',thats='TRUE');
```
`r gimme('n',of='age',mo=format)` individuals completed the HMRFS survey across all sites. Of these respondents, most self-reported as female (`r gimme(of='sex',thats='Female')`),  Caucasian  (`r gimme(of='White')`), and  having  private  insurance  (`r gimme(of='insurance',thats='Private')`). The modal range of self-reported household  income  was approximately $50,000-$100,000/year and average age was `r gimme('mean',of='age',m=format,di=3)` years with a baseline mean BMI of `r gimme('mean',of='a_bmi',m=format,di=4)` (`r gimme('sd',of='a_bmi',m=format,di=3)`). These data indicate the sample that responded to the HMRFS survey was similar to the overall cohort of eligible patients. Responses indicate that across all sites (Table 8a), `r gimme(of='research',thats='Yes')` of respondents had participated previously in medical research. Respondents were generally open to investigators contacting them about possible participation in studies (`r gimme(of='possible_research',thats='Yes')` yes; `r gimme(of='possible_research',thats='Maybe')` maybe). Key factors in making the decision to participate in medical research included: topic of research  (`r gimme(of='PR_Me_DependsAbout')`),  time  (`r gimme(of='PR_Me_Time')`),  doctor  recommendation  (`r gimme(of='PR_Me_Doctor_Op')`),  reimbursement  (`r gimme(of='PR_Me_Compensation')`), and child involvement (`r gimme(of='PR_Me_Involve_Child')`). Of respondents who  had  children  (`r gimme(of='children_in_home',thats='Yes')`), they  were  also  generally  positive  about possibly allowing their child to take part in medical research (`r gimme(of='children_research',thats='Yes',data=tb$dSurvHaveKids)` yes; `r gimme(of='children_research',thats='Yes',data=tb$dSurvHaveKids)` maybe) (Table 8b). The factors for deciding whether their children could participate in research followed the same order of priority as above. Most participants were in favor of their medical information being used for research (`r gimme(of='research_feeling',thats='Fantastic')` fantastic idea, `r gimme(of='research_feeling',thats='GoodIdea')` good idea) and even more so if the data being used for medical research is de-identified (`r gimme(of='deid_data',thats='Fantastic')` fantastic idea, `r gimme(of='deid_data',thats='GoodIdea')` good idea). 
```{r}
cat(tb$t08A.survresp);
```
---
```{r}
cat(tb$t08B.survrespkids);
```

# Discsussion

# Conclusion

# Supplementary Materials

```{r, results='asis',echo=FALSE, message=FALSE, warning=FALSE}
cat(tb$t0S1.eligByRecruit);
```
